<?php
$currency_dropdown=array(
    array("id"=>"AUD","text"=>"AUD"),
    array("id"=>"GBP","text"=>"GBP"),
    array("id"=>"EUR","text"=>"EUR"),
    array("id"=>"JPY","text"=>"JPY"),
    array("id"=>"CHF","text"=>"CHF"),
    array("id"=>"USD","text"=>"USD"),
    array("id"=>"AFN","text"=>"AFN"),
    array("id"=>"ALL","text"=>"ALL"),
    array("id"=>"DZD","text"=>"DZD"),
    array("id"=>"AOA","text"=>"AOA"),
    array("id"=>"ARS","text"=>"ARS"),
    array("id"=>"AMD","text"=>"AMD"),
    array("id"=>"AWG","text"=>"AWG"),
    array("id"=>"AUD","text"=>"AUD"),
    array("id"=>"ATS (EURO)","text"=>"ATS (EURO)"),
    array("id"=>"BEF (EURO)","text"=>"BEF (EURO)"),
    array("id"=>"AZN","text"=>"AZN"),
    array("id"=>"BSD","text"=>"BSD"),
    array("id"=>"BHD","text"=>"BHD"),
    array("id"=>"BDT","text"=>"BDT"),
    array("id"=>"BBD","text"=>"BBD"),
    array("id"=>"BYR","text"=>"BYR"),
    array("id"=>"BZD","text"=>"BZD"),
    array("id"=>"BMD","text"=>"BMD"),
    array("id"=>"BTN","text"=>"BTN"),
    array("id"=>"BOB","text"=>"BOB"),
    array("id"=>"BAM","text"=>"BAM"),
    array("id"=>"BWP","text"=>"BWP"),
    array("id"=>"BRL","text"=>"BRL"),
    array("id"=>"GBP","text"=>"GBP"),
    array("id"=>"BND","text"=>"BND"),
    array("id"=>"BGN","text"=>"BGN"),
    array("id"=>"BIF","text"=>"BIF"),
    array("id"=>"XOF","text"=>"XOF"),
    array("id"=>"XAF","text"=>"XAF"),
    array("id"=>"XPF","text"=>"XPF"),
    array("id"=>"KHR","text"=>"KHR"),
    array("id"=>"CAD","text"=>"CAD"),
    array("id"=>"CVE","text"=>"CVE"),
    array("id"=>"KYD","text"=>"KYD"),
    array("id"=>"CLP","text"=>"CLP"),
    array("id"=>"CNY","text"=>"CNY"),
    array("id"=>"COP","text"=>"COP"),
    array("id"=>"KMF","text"=>"KMF"),
    array("id"=>"CDF","text"=>"CDF"),
    array("id"=>"CRC","text"=>"CRC"),
    array("id"=>"HRK","text"=>"HRK"),
    array("id"=>"CUC","text"=>"CUC"),
    array("id"=>"CUP","text"=>"CUP"),
    array("id"=>"CYP (EURO)","text"=>"CYP (EURO)"),
    array("id"=>"CZK","text"=>"CZK"),
    array("id"=>"DKK","text"=>"DKK"),
    array("id"=>"DJF","text"=>"DJF"),
    array("id"=>"DOP","text"=>"DOP"),
    array("id"=>"XCD","text"=>"XCD"),
    array("id"=>"EGP","text"=>"EGP"),
    array("id"=>"SVC","text"=>"SVC"),
    array("id"=>"EEK (EURO)","text"=>"EEK (EURO)"),
    array("id"=>"ETB","text"=>"ETB"),
    array("id"=>"EUR","text"=>"EUR"),
    array("id"=>"FKP","text"=>"FKP"),
    array("id"=>"FIM (EURO)","text"=>"FIM (EURO)"),
    array("id"=>"FJD","text"=>"FJD"),
    array("id"=>"GMD","text"=>"GMD"),
    array("id"=>"GEL","text"=>"GEL"),
    array("id"=>"DMK (EURO)","text"=>"DMK (EURO)"),
    array("id"=>"GHS","text"=>"GHS"),
    array("id"=>"GIP","text"=>"GIP"),
    array("id"=>"GRD (EURO)","text"=>"GRD (EURO)"),
    array("id"=>"GTQ","text"=>"GTQ"),
    array("id"=>"GNF","text"=>"GNF"),
    array("id"=>"GYD","text"=>"GYD"),
    array("id"=>"HTG","text"=>"HTG"),
    array("id"=>"HNL","text"=>"HNL"),
    array("id"=>"HKD","text"=>"HKD"),
    array("id"=>"HUF","text"=>"HUF"),
    array("id"=>"ISK","text"=>"ISK"),
    array("id"=>"INR","text"=>"INR"),
    array("id"=>"IDR","text"=>"IDR"),
    array("id"=>"IRR","text"=>"IRR"),
    array("id"=>"IQD","text"=>"IQD"),
    array("id"=>"IED (EURO)","text"=>"IED (EURO)"),
    array("id"=>"ILS","text"=>"ILS"),
    array("id"=>"ITL (EURO)","text"=>"ITL (EURO)"),
    array("id"=>"JMD","text"=>"JMD"),
    array("id"=>"JPY","text"=>"JPY"),
    array("id"=>"JOD","text"=>"JOD"),
    array("id"=>"KZT","text"=>"KZT"),
    array("id"=>"KES","text"=>"KES"),
    array("id"=>"KWD","text"=>"KWD"),
    array("id"=>"KGS","text"=>"KGS"),
    array("id"=>"LAK","text"=>"LAK"),
    array("id"=>"LVL (EURO)","text"=>"LVL (EURO)"),
    array("id"=>"LBP","text"=>"LBP"),
    array("id"=>"LSL","text"=>"LSL"),
    array("id"=>"LRD","text"=>"LRD"),
    array("id"=>"LYD","text"=>"LYD"),
    array("id"=>"LTL (EURO)","text"=>"LTL (EURO)"),
    array("id"=>"LUF (EURO)","text"=>"LUF (EURO)"),
    array("id"=>"MOP","text"=>"MOP"),
    array("id"=>"MKD","text"=>"MKD"),
    array("id"=>"MGA","text"=>"MGA"),
    array("id"=>"MWK","text"=>"MWK"),
    array("id"=>"MYR","text"=>"MYR"),
    array("id"=>"MVR","text"=>"MVR"),
    array("id"=>"MTL (EURO)","text"=>"MTL (EURO)"),
    array("id"=>"MRO","text"=>"MRO"),
    array("id"=>"MUR","text"=>"MUR"),
    array("id"=>"MXN","text"=>"MXN"),
    array("id"=>"MDL","text"=>"MDL"),
    array("id"=>"MNT","text"=>"MNT"),
    array("id"=>"MAD","text"=>"MAD"),
    array("id"=>"MZN","text"=>"MZN"),
    array("id"=>"MMK","text"=>"MMK"),
    array("id"=>"ANG","text"=>"ANG"),
    array("id"=>"NAD","text"=>"NAD"),
    array("id"=>"NPR","text"=>"NPR"),
    array("id"=>"NLG (EURO)","text"=>"NLG (EURO)"),
    array("id"=>"NZD","text"=>"NZD"),
    array("id"=>"NIO","text"=>"NIO"),
    array("id"=>"NGN","text"=>"NGN"),
    array("id"=>"KPW","text"=>"KPW"),
    array("id"=>"NOK","text"=>"NOK"),
    array("id"=>"OMR","text"=>"OMR"),
    array("id"=>"PKR","text"=>"PKR"),
    array("id"=>"PAB","text"=>"PAB"),
    array("id"=>"PGK","text"=>"PGK"),
    array("id"=>"PYG","text"=>"PYG"),
    array("id"=>"PEN","text"=>"PEN"),
    array("id"=>"PHP","text"=>"PHP"),
    array("id"=>"PLN","text"=>"PLN"),
    array("id"=>"PTE (EURO)","text"=>"PTE (EURO)"),
    array("id"=>"QAR","text"=>"QAR"),
    array("id"=>"RON","text"=>"RON"),
    array("id"=>"RUB","text"=>"RUB"),
    array("id"=>"RWF","text"=>"RWF"),
    array("id"=>"WST","text"=>"WST"),
    array("id"=>"STD","text"=>"STD"),
    array("id"=>"SAR","text"=>"SAR"),
    array("id"=>"RSD","text"=>"RSD"),
    array("id"=>"SCR","text"=>"SCR"),
    array("id"=>"SLL","text"=>"SLL"),
    array("id"=>"SGD","text"=>"SGD"),
    array("id"=>"SKK (EURO)","text"=>"SKK (EURO)"),
    array("id"=>"SIT (EURO)","text"=>"SIT (EURO)"),
    array("id"=>"SBD","text"=>"SBD"),
    array("id"=>"SOS","text"=>"SOS"),
    array("id"=>"ZAR","text"=>"ZAR"),
    array("id"=>"KRW","text"=>"KRW"),
    array("id"=>"ESP (EURO)","text"=>"ESP (EURO)"),
    array("id"=>"LKR","text"=>"LKR"),
    array("id"=>"SHP","text"=>"SHP"),
    array("id"=>"SDG","text"=>"SDG"),
    array("id"=>"SRD","text"=>"SRD"),
    array("id"=>"SZL","text"=>"SZL"),
    array("id"=>"SEK","text"=>"SEK"),
    array("id"=>"CHF","text"=>"CHF"),
    array("id"=>"SYP","text"=>"SYP"),
    array("id"=>"TWD","text"=>"TWD"),
    array("id"=>"TZS","text"=>"TZS"),
    array("id"=>"THB","text"=>"THB"),
    array("id"=>"TOP","text"=>"TOP"),
    array("id"=>"TTD","text"=>"TTD"),
    array("id"=>"TND","text"=>"TND"),
    array("id"=>"TRY","text"=>"TRY"),
    array("id"=>"TMM","text"=>"TMM"),
    array("id"=>"USD","text"=>"USD"),
    array("id"=>"UGX","text"=>"UGX"),
    array("id"=>"UAH","text"=>"UAH"),
    array("id"=>"UYU","text"=>"UYU"),
    array("id"=>"AED","text"=>"AED"),
    array("id"=>"VUV","text"=>"VUV"),
    array("id"=>"VEB","text"=>"VEB"),
    array("id"=>"VND","text"=>"VND"),
    array("id"=>"YER","text"=>"YER"),
    array("id"=>"ZMK","text"=>"ZMK"),
    array("id"=>"ZWD","text"=>"ZWD"));
?>
<div id="ajaxModalContent" >
<div class="modal-body clearfix" id="add-currency-rate-modal" >
    <!-- <div class="card" > -->
        <!-- <div class="card-header" > -->
            <h3>
                Register new currency and exchange rate
            </h3>
            <p>Rates can be changed later.</p>
        <!-- </div> -->
        <!-- <div class="card-body" > -->
            <div class="row" >
                <div class="col-md-4" >
                    <div class="form-group" >
                        <label>From:</label>
                        <input
                        name="input_from_currency"
                        id="input_from_currency"
                        class="form-control currency_dropdown"
                        />
                    </div>
                    <div class="form-group" >
                        <label>To:</label>
                        <input
                        name="input_to_currency"
                        id="input_to_currency"
                        class="form-control currency_dropdown"
                        value="<?php if(isset($project_info)&&isset($project_info->currency)) echo $project_info->currency; ?>"
                        />
                    </div>
                    <div class="form-group" >
                        <label>Rate:</label>
                        <input
                        name="input_rate"
                        id="input_rate"
                        class="form-control"
                        type="number"
                        value="1.00"
                        step="0.01"
                        />
                    </div>
                </div>
            </div>
        <!-- </div> -->
        <!-- <div class="card-footer" > -->
            <div class="d-flex align-items-center" >
                <button class="btn btn-default" >Cancel</button>
                <div class="flex-grow-1" ></div>
                <button id="btn-save-currency-rate" class="btn btn-primary " >Save</button>
            </div>
        <!-- </div> -->
    <!-- </div> -->
</div>
</div>
<script>
    $(document).ready(function(){
        $(".modal-dialog").addClass('modal-xl').addClass('modal-dialog-centered');
        $(".currency_dropdown").select2({
            data:<?php echo json_encode($currency_dropdown);?>
        });
        $("#btn-save-currency-rate").on("click",function(){
            var from=$("#input_from_currency")[0].value;
            var to=$("#input_to_currency")[0].value;
            var rate=$("#input_rate")[0].value;
            if(!from||!to) return;
            $.ajax({
                url:'<?php echo get_uri("projects/save_currency_rate");?>',
                method:"POST",
                data:{
                    from,
                    to,
                    rate,
                    project_id:<?php echo $project_id;?>
                },
                success:function(response){
                    if(JSON.parse(response).success){
                        $maskTarget=$("#ajaxModalContent").find(".modal-body");
                        var padding = $maskTarget.height() - 80;
                        if (padding > 0) {
                            padding = Math.floor(padding / 2);
                        }
                        $maskTarget.after("<div class='modal-mask'><div class='circle-loader'></div></div>");
                        //check scrollbar
                        var height = $maskTarget.outerHeight();
                        $('.modal-mask').css({"width": $maskTarget.width() + 22 + "px", "height": height + "px", "padding-top": padding + "px"});
                        $maskTarget.closest('.modal-dialog').find('[type="submit"]').attr('disabled', 'disabled');
                        $maskTarget.addClass("hide");
                        window.add_currency_rate_panel.closeModal()
                    }
                    
                }
            })
            
        })
        window.add_currency_rate_panel=$("#add-currency-rate-modal").appForm({
            closeModalOnSuccess: false,
        })
    })
</script>
